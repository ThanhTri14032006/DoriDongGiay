<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Sản Phẩm | Dori Đông Giày Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin-style.css">
</head>
<body>
<div class="wrapper">
    <!-- Header -->
    <div id="header-placeholder"></div>
    <!-- End Header -->

    <!-- Page Content -->
    <div id="content">
        <!-- Top Navbar -->
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <button type="button" id="sidebarCollapse" class="btn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="navbar-brand ms-3">
                    <h5 class="mb-0">Quản Lý Sản Phẩm</h5>
                </div>
                <div class="ms-auto d-flex align-items-center">
                    <div class="dropdown me-3">
                        <a class="nav-link dropdown-toggle position-relative" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-bell"></i>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">3</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><h6 class="dropdown-header">Thông Báo</h6></li>
                            <li><a class="dropdown-item" href="#">Đơn hàng mới #1234</a></li>
                            <li><a class="dropdown-item" href="#">Hết hàng: Giày Nike Air</a></li>
                            <li><a class="dropdown-item" href="#">Bình luận mới cần duyệt</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-center" href="#">Xem tất cả</a></li>
                        </ul>
                    </div>
                    <div class="dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <div class="avatar-sm rounded-circle bg-soft-primary me-2">
                                <div class="avatar-title text-primary">A</div>
                            </div>
                            <span class="d-none d-sm-inline">Admin</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="profile.html"><i class="fas fa-user me-2"></i>Hồ sơ</a></li>
                            <li><a class="dropdown-item" href="settings.html"><i class="fas fa-cog me-2"></i>Cài đặt</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="login.html"><i class="fas fa-sign-out-alt me-2"></i>Đăng xuất</a></li>
                        </ul>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Products Content -->
            <div class="container-fluid">
                <!-- Page Header -->
                <div class="d-flex align-items-center justify-content-between mb-4">
                    <div>
                        <h1 class="h3 mb-1 text-dark fw-bold">Quản Lý Sản Phẩm</h1>
                        <p class="text-muted mb-0">Quản lý toàn bộ sản phẩm trong cửa hàng</p>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary">
                            <i class="fas fa-download me-2"></i>Xuất Excel
                        </button>
                        <a href="product-add.html" class="btn btn-primary">
                            <i class="fas fa-plus me-2"></i>Thêm Sản Phẩm
                        </a>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stats-card">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <div class="text-xs fw-bold text-primary text-uppercase mb-1">Tổng Sản Phẩm</div>
                                    <div class="h5 mb-0 fw-bold text-gray-800">1,247</div>
                                </div>
                                <div class="icon">
                                    <i class="fas fa-box text-primary"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stats-card">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <div class="text-xs fw-bold text-success text-uppercase mb-1">Còn Hàng</div>
                                    <div class="h5 mb-0 fw-bold text-gray-800">1,156</div>
                                </div>
                                <div class="icon">
                                    <i class="fas fa-check-circle text-success"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stats-card">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <div class="text-xs fw-bold text-warning text-uppercase mb-1">Sắp Hết</div>
                                    <div class="h5 mb-0 fw-bold text-gray-800">67</div>
                                </div>
                                <div class="icon">
                                    <i class="fas fa-exclamation-triangle text-warning"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="stats-card">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <div class="text-xs fw-bold text-danger text-uppercase mb-1">Hết Hàng</div>
                                    <div class="h5 mb-0 fw-bold text-gray-800">24</div>
                                </div>
                                <div class="icon">
                                    <i class="fas fa-times-circle text-danger"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Filters -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h6 class="mb-0 fw-bold">Bộ Lọc & Tìm Kiếm</h6>
                    </div>
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-4">
                                <label for="searchProduct" class="form-label fw-semibold">Tìm kiếm</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                    <input type="text" class="form-control" id="searchProduct" placeholder="Tên sản phẩm, mã sản phẩm...">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <label for="categoryFilter" class="form-label fw-semibold">Danh mục</label>
                                <select class="form-select" id="categoryFilter">
                                    <option value="">Tất cả</option>
                                    <option value="1">Giày Thể Thao</option>
                                    <option value="2">Giày Casual</option>
                                    <option value="3">Giày Đá Bóng</option>
                                    <option value="4">Giày Sandal</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="statusFilter" class="form-label fw-semibold">Trạng thái</label>
                                <select class="form-select" id="statusFilter">
                                    <option value="">Tất cả</option>
                                    <option value="1">Còn hàng</option>
                                    <option value="0">Hết hàng</option>
                                    <option value="2">Sắp hết</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="sortBy" class="form-label fw-semibold">Sắp xếp</label>
                                <select class="form-select" id="sortBy">
                                    <option value="newest">Mới nhất</option>
                                    <option value="oldest">Cũ nhất</option>
                                    <option value="name_asc">Tên A-Z</option>
                                    <option value="name_desc">Tên Z-A</option>
                                    <option value="price_asc">Giá tăng dần</option>
                                    <option value="price_desc">Giá giảm dần</option>
                                </select>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-filter me-2"></i>Lọc
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Products Table -->
                <div class="card mb-4">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <h6 class="mb-0 fw-bold">Danh Sách Sản Phẩm</h6>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-danger" id="deleteSelected" disabled>
                                <i class="fas fa-trash me-1"></i>Xóa đã chọn
                            </button>
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-export me-2"></i>Xuất Excel</a></li>
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-file-import me-2"></i>Nhập Excel</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-sync me-2"></i>Làm mới</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 50px;">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="selectAll">
                                            </div>
                                        </th>
                                        <th style="width: 80px;">Ảnh</th>
                                        <th style="width: 100px;">Mã SP</th>
                                        <th>Tên Sản Phẩm</th>
                                        <th style="width: 120px;">Danh Mục</th>
                                        <th style="width: 100px;">Giá</th>
                                        <th style="width: 80px;">Tồn Kho</th>
                                        <th style="width: 100px;">Trạng Thái</th>
                                        <th style="width: 120px;">Thao Tác</th>
                                    </tr>
                                </thead>
                                <tbody id="productTableBody">
                                    <!-- Sample Product Data -->
                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="1">
                                            </div>
                                        </td>
                                        <td>
                                            <img src="../img/products/product1.jpg" alt="Product" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                                        </td>
                                        <td><span class="fw-semibold">#SP001</span></td>
                                        <td>
                                            <div>
                                                <div class="fw-semibold">Nike Air Max 270</div>
                                                <small class="text-muted">Giày thể thao nam</small>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-soft-primary text-primary">Thể Thao</span></td>
                                        <td><span class="fw-bold text-success">2,500,000₫</span></td>
                                        <td><span class="fw-semibold">45</span></td>
                                        <td><span class="badge bg-success">Còn hàng</span></td>
                                        <td>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-sm btn-outline-primary" title="Xem">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-warning" title="Sửa">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-danger" title="Xóa">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="2">
                                            </div>
                                        </td>
                                        <td>
                                            <img src="../img/products/product2.jpg" alt="Product" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                                        </td>
                                        <td><span class="fw-semibold">#SP002</span></td>
                                        <td>
                                            <div>
                                                <div class="fw-semibold">Adidas Ultraboost 22</div>
                                                <small class="text-muted">Giày chạy bộ</small>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-soft-primary text-primary">Thể Thao</span></td>
                                        <td><span class="fw-bold text-success">3,200,000₫</span></td>
                                        <td><span class="fw-semibold text-warning">8</span></td>
                                        <td><span class="badge bg-warning">Sắp hết</span></td>
                                        <td>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-sm btn-outline-primary" title="Xem">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-warning" title="Sửa">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-danger" title="Xóa">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="3">
                                            </div>
                                        </td>
                                        <td>
                                            <img src="../img/products/product3.jpg" alt="Product" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                                        </td>
                                        <td><span class="fw-semibold">#SP003</span></td>
                                        <td>
                                            <div>
                                                <div class="fw-semibold">Converse Chuck Taylor</div>
                                                <small class="text-muted">Giày casual unisex</small>
                                            </div>
                                        </td>
                                        <td><span class="badge bg-soft-info text-info">Casual</span></td>
                                        <td><span class="fw-bold text-success">1,800,000₫</span></td>
                                        <td><span class="fw-semibold text-danger">0</span></td>
                                        <td><span class="badge bg-danger">Hết hàng</span></td>
                                        <td>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-sm btn-outline-primary" title="Xem">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-warning" title="Sửa">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-outline-danger" title="Xóa">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Pagination -->
                        <div class="d-flex align-items-center justify-content-between p-3 border-top">
                            <div class="text-muted">
                                Hiển thị <strong>1-10</strong> trong tổng số <strong>1,247</strong> sản phẩm
                            </div>
                            <nav aria-label="Page navigation">
                                <ul class="pagination pagination-sm mb-0">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1" aria-disabled="true">
                                            <i class="fas fa-chevron-left"></i>
                                        </a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item"><a class="page-link" href="#">...</a></li>
                                    <li class="page-item"><a class="page-link" href="#">125</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">
                                            <i class="fas fa-chevron-right"></i>
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">Xác Nhận Xóa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Bạn có chắc chắn muốn xóa sản phẩm này không? Hành động này không thể hoàn tác.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-danger">Xóa</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Product Modal -->
    <div class="modal fade" id="viewModal" tabindex="-1" aria-labelledby="viewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewModalLabel">Chi Tiết Sản Phẩm</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <img src="../img/products/product-1.jpg" class="img-fluid" alt="Product">
                        </div>
                        <div class="col-md-6">
                            <h4>Giày Nike Air Max</h4>
                            <p class="text-muted">Mã sản phẩm: SP001</p>
                            <p><strong>Danh mục:</strong> Giày Thể Thao</p>
                            <p><strong>Giá:</strong> 2,500,000 VNĐ</p>
                            <p><strong>Tồn kho:</strong> 12</p>
                            <p><strong>Trạng thái:</strong> <span class="badge bg-success">Còn hàng</span></p>
                            <p><strong>Ngày tạo:</strong> 15/05/2023</p>
                            <p><strong>Cập nhật lần cuối:</strong> 20/06/2023</p>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-12">
                            <h5>Mô tả sản phẩm</h5>
                            <p>Nike Air Max là dòng giày thể thao cao cấp với công nghệ đệm khí Air độc quyền của Nike, mang lại sự thoải mái và hỗ trợ tối đa cho người sử dụng. Thiết kế hiện đại, thời trang phù hợp cho cả nam và nữ.</p>
                            
                            <h5 class="mt-3">Thông số kỹ thuật</h5>
                            <ul>
                                <li>Chất liệu: Vải mesh, da tổng hợp</li>
                                <li>Đế: Công nghệ Air Max</li>
                                <li>Màu sắc: Đen, Trắng, Xám</li>
                                <li>Size: 39-44</li>
                                <li>Xuất xứ: Chính hãng</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <a href="product-edit.html?id=1" class="btn btn-primary">Chỉnh Sửa</a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/include.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/api.js"></script>
      <script>
           // Dữ liệu mẫu sản phẩm
           const sampleProducts = [
               { id: 1, name: "Giày Nike Air Max", category: "Giày Thể Thao", price: 2500000, stock: 12, imageUrl: "../img/products/product-1.jpg", sku: "SP001" },
               { id: 2, name: "Giày Adidas Ultraboost", category: "Giày Thể Thao", price: 3200000, stock: 8, imageUrl: "../img/products/product-2.jpg", sku: "SP002" },
               { id: 3, name: "Giày Converse Classic", category: "Giày Casual", price: 1500000, stock: 15, imageUrl: "../img/products/product-3.jpg", sku: "SP003" },
               { id: 4, name: "Giày Vans Old Skool", category: "Giày Casual", price: 1800000, stock: 10, imageUrl: "../img/products/product-4.jpg", sku: "SP004" },
               { id: 5, name: "Giày Nike Mercurial", category: "Giày Đá Bóng", price: 2800000, stock: 0, imageUrl: "../img/products/product-5.jpg", sku: "SP005" }
           ];
           
           $(document).ready(function () {
            // Toggle sidebar
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
            });

            // Select all checkboxes
            $('#selectAll').on('click', function() {
                $('input[type="checkbox"]').prop('checked', $(this).prop('checked'));
            });
        });
        
        // Hàm format giá tiền
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(price);
        }

        // Tải danh sách sản phẩm
         async function loadProducts() {
             try {
                 const products = sampleProducts; // Sử dụng dữ liệu mẫu
                 const tableBody = document.getElementById('productTableBody');
                 tableBody.innerHTML = '';
                
                products.forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="${product.id}">
                            </div>
                        </td>
                        <td><img src="${product.imageUrl || '../img/products/default.jpg'}" width="50" height="50" alt="${product.name}"></td>
                        <td>${product.sku || 'SP' + product.id}</td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>${formatPrice(product.price)}</td>
                        <td>${product.stock}</td>
                        <td><span class="badge ${product.stock > 0 ? 'bg-success' : 'bg-danger'}">${product.stock > 0 ? 'Còn hàng' : 'Hết hàng'}</span></td>
                        <td>
                            <div class="btn-group">
                                <a href="product-edit.html?id=${product.id}" class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></a>
                                <button type="button" class="btn btn-sm btn-danger" onclick="deleteProduct(${product.id})"><i class="fas fa-trash"></i></button>
                                <button type="button" class="btn btn-sm btn-info" onclick="viewProduct(${product.id})"><i class="fas fa-eye"></i></button>
                            </div>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            } catch (error) {
                console.error('Lỗi khi tải sản phẩm:', error);
                alert('Không thể tải danh sách sản phẩm. Vui lòng thử lại sau.');
            }
        }

        // Xóa sản phẩm
         async function deleteProduct(id) {
             if (confirm('Bạn có chắc chắn muốn xóa sản phẩm này?')) {
                 try {
                     // Xóa sản phẩm từ mảng dữ liệu mẫu
                     const index = sampleProducts.findIndex(p => p.id == id);
                     if (index !== -1) {
                         sampleProducts.splice(index, 1);
                     }
                     alert('Xóa sản phẩm thành công!');
                     loadProducts(); // Tải lại danh sách
                 } catch (error) {
                     console.error('Lỗi khi xóa sản phẩm:', error);
                     alert('Không thể xóa sản phẩm. Vui lòng thử lại sau.');
                 }
             }
         }

         // Xem chi tiết sản phẩm
         async function viewProduct(id) {
             try {
                 // Tìm sản phẩm từ mảng dữ liệu mẫu
                 const product = sampleProducts.find(p => p.id == id);
                 if (product) {
                     alert(`Chi tiết sản phẩm: ${product.name}\nGiá: ${formatPrice(product.price)}\nSố lượng: ${product.stock}`);
                 } else {
                     alert('Không tìm thấy sản phẩm!');
                 }
             } catch (error) {
                 console.error('Lỗi khi tải chi tiết sản phẩm:', error);
                 alert('Không thể tải chi tiết sản phẩm. Vui lòng thử lại sau.');
             }
         }

        // Tải sản phẩm khi trang được tải
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
        });
    </script>
</body>
</html>